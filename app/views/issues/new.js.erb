var involved_project_ids = $('#issue_project_ids').val();
if (involved_project_ids == null) {
    involved_project_ids = '';
}

/** Start Standard Redmine */

replaceIssueFormWith('<%= escape_javascript(render :partial => 'form') %>');
<% case params[:form_update_triggered_by] %>
<% when "issue_project_id" %>
$("#watchers_form_container").html('<%= escape_javascript(render :partial => 'issues/watchers_form') %>');
<% when "issue_category_id" %>
$('#issue_assigned_to_id').find('option').first().html('<%= escape_javascript(@issue.category.try(:assigned_to).try(:name)).presence || '&nbsp;'.html_safe %>');
<% end %>

/** End Standard Redmine */

$('#issue_project_ids').val(involved_project_ids);

var htmlContent = "";
$.each(involved_project_ids, function (key, name) {
    htmlContent += ' <span class="list_projects_names">';
    htmlContent += $('#issue_project_ids option[value=' + name + ']').html().replace(/&nbsp;/gi, '').replace("Â» ", "");
    htmlContent += "</span>";
});
$("#projects_form #list_of_projects_per_issue").html(htmlContent);
if (htmlContent == "") {
    $(".and_x_other_projects").css("display", "none");
    $("#answers-on-secondary-projects").hide()
} else {
    $(".and_x_other_projects").css("display", "inline");
    $("#answers-on-secondary-projects").show()
}
